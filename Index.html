
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Run 3 – Mobile Stable Final</title>

<meta name="viewport"
      content="width=device-width,height=device-height,initial-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">

<link rel="shortcut icon"
      href="https://cdn.jsdelivr.net/gh/VinMannie/Run_3@gh-pages/favicon.png">

<script src="https://cdn.jsdelivr.net/gh/cooldude2349/bugfixes@main/Run3beta.js"></script>

<style>
html,body{
    margin:0;
    padding:0;
    height:100%;
    overflow:hidden;
    background:#000;
}
#openfl-content{
    width:100%;
    height:100%;
}
</style>
</head>

<body>
<div id="openfl-content"></div>

<script>
lime.embed("Run3", "openfl-content", 800, 600, {});

/* ===== KEY ===== */
function key(type, code, kc){
    document.dispatchEvent(new KeyboardEvent(type,{
        code: code,
        key: code==="Space" ? " " : code,
        keyCode: kc,
        which: kc,
        bubbles:true
    }));
}

/* ===== TAP & DOUBLE TAP ===== */
let lastTap = 0;

document.addEventListener("touchstart", e=>{
    e.preventDefault();

    const now = Date.now();
    const delta = now - lastTap;

    // single tap = nhảy ngắn
    if(delta > 300){
        key("keydown","Space",32);
        setTimeout(()=>key("keyup","Space",32),120);
    }
    // double tap = nhảy xa
    else{
        key("keydown","Space",32);
        setTimeout(()=>key("keyup","Space",32),260);
    }

    lastTap = now;
},{passive:false});

/* ===== ROTATE: TAP EDGE ===== */
document.addEventListener("touchstart", e=>{
    const x = e.touches[0].clientX;
    const w = window.innerWidth;

    // trái màn hình
    if(x < w * 0.2){
        key("keydown","ArrowLeft",37);
        setTimeout(()=>key("keyup","ArrowLeft",37),80);
    }
    // phải màn hình
    else if(x > w * 0.8){
        key("keydown","ArrowRight",39);
        setTimeout(()=>key("keyup","ArrowRight",39),80);
    }
},{passive:false});
</script>

</body>
</html>
